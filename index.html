<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡∏´‡∏°‡∏π‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡πÄ‡∏à‡πä‡∏ô‡πâ‡∏≠‡∏á</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #fefefe; }
    h1, h3, h4 { text-align: center; }
    .menu { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .item { background: #e0f7fa; padding: 10px; border-radius: 10px; cursor: pointer; text-align: center; }
    .item:hover { background: #b2ebf2; }
    .summary { margin-top: 20px; }
    button { padding: 10px 20px; font-size: 16px; margin: 5px; }
    .bill, .history, .report { white-space: pre-wrap; background: #f1f8e9; padding: 10px; border-radius: 10px; margin-top: 10px; }
    input[type="number"] { padding: 8px; font-size: 16px; width: 100px; text-align: center; }
    label { font-weight: bold; }
  </style>
</head>
<body>
<button onclick="saveOrder()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
<button onclick="showPendingOrders()">üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
<div class="history" id="pendingList"></div>
<h1>POS ‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß</h1>

<div style="text-align: center; margin-bottom: 10px;">
  <label>‡πÇ‡∏ï‡πä‡∏∞‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</label>
  <input type="number" id="tableNumber" min="1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5" />
</div>

<div class="menu" id="menu"></div>

<div class="summary">
  <h3>‡∏£‡∏ß‡∏°: <span id="total">0</span> ‡∏ö‡∏≤‡∏ó</h3>
  <button onclick="checkout()">‚úÖ ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô</button>
  <button onclick="undoItem()">‚Ü©Ô∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
  <button onclick="resetAll()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  <div class="bill" id="bill"></div>
  <h4>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <span id="sales">0</span> ‡∏ö‡∏≤‡∏ó</h4>
  <button onclick="showHistory()">üìú ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</button>
  <button onclick="exportCSV()">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
  <button onclick="showReport()">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÇ‡∏ï‡πä‡∏∞</button>
  <div class="history" id="history"></div>
  <div class="report" id="report"></div>
</div>
<script>
let pendingOrders = {};
const menuItems = [
  {
    name: "‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡∏´‡∏°‡∏π‡πÄ‡∏•‡∏µ‡∏¢‡∏á",
    type: "‡∏´‡∏°‡∏π‡πÄ‡∏•‡∏µ‡∏¢‡∏á",
    basePrice: 40,
    options: {
      soupType: ["‡∏ô‡πâ‡∏≥", "‡πÅ‡∏´‡πâ‡∏á"],
      noodles: [
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà", addPrice: 0 },
        { type: "‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏°‡∏µ‡πà‡∏Ç‡∏≤‡∏ß", addPrice: 0 },
        { type: "‡πÑ‡∏ß‡πÑ‡∏ß", addPrice: 5 }
      ]
    }
  },
  {
    name: "‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏µ‡∏¢‡∏á",
    type: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏µ‡∏¢‡∏á",
    basePrice: 50,
    options: {
      soupType: ["‡∏ô‡πâ‡∏≥", "‡πÅ‡∏´‡πâ‡∏á"],
      noodles: [
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà", addPrice: 0 },
        { type: "‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏°‡∏µ‡πà‡∏Ç‡∏≤‡∏ß", addPrice: 0 },
        { type: "‡πÑ‡∏ß‡πÑ‡∏ß", addPrice: 5 }
      ]
    }
  },
  {
    name: "‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡∏ã‡∏µ‡πà‡πÇ‡∏Ñ‡∏£‡∏á‡∏´‡∏°‡∏π‡∏ï‡∏∏‡πã‡∏ô",
    type: "‡∏ã‡∏µ‡πà‡πÇ‡∏Ñ‡∏£‡∏á‡∏´‡∏°‡∏π",
    basePrice: 60,
    options: {
      soupType: ["‡∏ô‡πâ‡∏≥", "‡πÅ‡∏´‡πâ‡∏á"],
      noodles: [
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà", addPrice: 0 },
        { type: "‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà", addPrice: 0 },
        { type: "‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏°‡∏µ‡πà‡∏Ç‡∏≤‡∏ß", addPrice: 0 },
        { type: "‡πÑ‡∏ß‡πÑ‡∏ß", addPrice: 5 }
      ]
    }
  },
  {
    name: "‡πÄ‡∏Å‡∏≤‡πÄ‡∏´‡∏•‡∏≤‡πÄ‡∏•‡∏µ‡∏¢‡∏á",
    type: "‡πÄ‡∏Å‡∏≤‡πÄ‡∏´‡∏•‡∏≤",
    basePrice: 50,
    options: {
      soupType: ["‡∏ô‡πâ‡∏≥"],
      noodles: []
    }
  },
  {
    name: "‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏´‡∏°‡∏π",
    type: "‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô",
    basePrice: 20,
    options: null
  },
  {
    name: "‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠",
    type: "‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô",
    basePrice: 25,
    options: null
  },
  {
    name: "‡πÅ‡∏Ñ‡∏õ‡∏´‡∏°‡∏π",
    type: "‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô",
    basePrice: 15,
    options: null
  },
  {
    name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏ß‡∏¢",
    type: "‡∏Ç‡πâ‡∏≤‡∏ß",
    basePrice: 10,
    options: null
  }
];

let order = [];
let salesTotal = Number(localStorage.getItem("salesTotal")) || 0;
let historyData = JSON.parse(localStorage.getItem("historyData") || "[]");

const menuDiv = document.getElementById("menu");
const totalSpan = document.getElementById("total");
const salesSpan = document.getElementById("sales");
const billDiv = document.getElementById("bill");
const historyDiv = document.getElementById("history");
const reportDiv = document.getElementById("report");
const tableInput = document.getElementById("tableNumber");

salesSpan.textContent = salesTotal;


// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏ô‡∏π (‡∏û‡∏£‡πâ‡∏≠‡∏° UI ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡πâ‡∏≥/‡πÄ‡∏™‡πâ‡∏ô)
menuItems.forEach((item, index) => {
  const div = document.createElement("div");
  div.className = "item";

  if (!item.options) {
    div.textContent = `${item.name} - ${item.basePrice} ‡∏ö‡∏≤‡∏ó`;
    div.onclick = () => {
      order.push({ name: item.name, price: item.basePrice });
      updateTotal();
    };
  } else {
    const label = document.createElement("label");
    label.textContent = item.name;
    div.appendChild(label);

    const soupSelect = document.createElement("select");
    item.options.soupType.forEach(soup => {
      const opt = document.createElement("option");
      opt.value = soup;
      opt.textContent = soup;
      soupSelect.appendChild(opt);
    });
    div.appendChild(document.createElement("br"));
    div.appendChild(document.createTextNode("‡∏ô‡πâ‡∏≥/‡πÅ‡∏´‡πâ‡∏á: "));
    div.appendChild(soupSelect);

    const noodleSelect = document.createElement("select");
    item.options.noodles.forEach(n => {
      const opt = document.createElement("option");
      opt.value = n.type;
      opt.textContent = n.type + (n.addPrice ? ` (+${n.addPrice} ‡∏ö‡∏≤‡∏ó)` : "");
      noodleSelect.appendChild(opt);
    });
    div.appendChild(document.createElement("br"));
    div.appendChild(document.createTextNode("‡πÄ‡∏™‡πâ‡∏ô: "));
    div.appendChild(noodleSelect);

    const btn = document.createElement("button");
    btn.textContent = "‡πÄ‡∏û‡∏¥‡πà‡∏°";
    btn.onclick = () => {
      const soup = soupSelect.value;
      const noodle = noodleSelect.value;
      const noodleData = item.options.noodles.find(n => n.type === noodle);
      const finalPrice = item.basePrice + (noodleData?.addPrice || 0);
      order.push({
        name: `${item.name} (${soup}, ${noodle})`,
        price: finalPrice
      });
      updateTotal();
    };
    div.appendChild(document.createElement("br"));
    div.appendChild(btn);
  }

  menuDiv.appendChild(div);
});

menuItems.forEach(item => {
  const div = document.createElement("div");
  div.className = "item";

  if (!item.options) {
    div.textContent = `${item.name} - ${item.basePrice} ‡∏ö‡∏≤‡∏ó`;
    div.onclick = () => {
      order.push({ name: item.name, price: item.basePrice });
      updateTotal();
    };
  } else {
    div.textContent = item.name;
    div.onclick = () => {
      const soup = prompt(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡∏Ç‡∏≠‡∏á "${item.name}"\n${item.options.soupType.join(", ")}`);
      if (!item.options.soupType.includes(soup)) {
        alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
      }

      const noodle = prompt(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏á "${item.name}"\n${item.options.noodles.map(n => n.type).join(", ")}`);
      const noodleData = item.options.noodles.find(n => n.type === noodle);
      if (!noodleData) {
        alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
      }

      const finalPrice = item.basePrice + noodleData.addPrice;
      order.push({
        name: `${item.name} (${soup}, ${noodle})`,
        price: finalPrice
      });
      updateTotal();
    };
  }

  menuDiv.appendChild(div);
});
</script>
</body>
</html>